
Read problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.
Chefina gave Chef a sequence F1,F2,…,FNF1,F2,…,FN as a birthday present. She constructed it from a sequence of positive integers A1,A2,…,ANA1,A2,…,AN in the following way: for each valid ii, Fi=∑ij=1(−1)(j+1)⋅AjFi=∑j=1i(−1)(j+1)⋅Aj.
Unfortunately, Chef was playing with the sequence FF and shuffled it. Now, he has a sequence denoted by BB, but he does not remember FF. The only things he knows are that FF is a permutation of BB and among all such permutations which Chefina could have constructed, her sequence FF was the lexicographically smallest.
Chef does not want to disappoint Chefina, but he is too busy in the kitchen, so he asked you to help him recover FF. Find the sequence FF he got from Chefina or determine that he made another mistake and a sequence that satisfies the given conditions does not exist.
Input

The first line of the input contains a single integer TT denoting the number of test cases. The description of TT test cases follows.
The first line of each test case contains a single integer NN.
The second line contains NN space-separated integers B1,B2,…,BNB1,B2,…,BN.

Output
For each test case:

If there is no solution, print a single line containing the string "NO" (without quotes).
Otherwise, print two lines.
The first of these lines should contain the string "YES" (without quotes).
The second line should contain NN space-separated integers F1,F2,…,FNF1,F2,…,FN.

Constraints

1≤T≤10,0001≤T≤10,000
1≤N≤1051≤N≤105
|Bi|≤109|Bi|≤109 for each valid ii
the sum of NN over all test cases does not exceed 106106

Subtasks
Subtask #1 (50 points): B1,B2,…,BNB1,B2,…,BN are pairwise distinct
Subtask #2 (50 points): original constraints

                        Sample Input 1
                        

4
2
1 2
3
-1 -2 -3
4
3 3 3 4
4
4 -4 4 -4

                        Sample Output 1
                        

YES
2 1
NO
NO
YES
4 -4 4 -4
Explanation
Example case 1: The only two permutations of BB are [1,2][1,2] and [2,1][2,1]. Out of them, [1,2][1,2] could not have been generated by Chefina, since it would require A=[1,−1]A=[1,−1], which contains a negative element. On the other hand, for [2,1][2,1], we get A=[2,1]A=[2,1], so F=[2,1]F=[2,1] must be the sequence Chefina generated.

Author:
5★dean_student
Editorial:
https://discuss.codechef.com/problems/RESTCH
Tags:

               
                 Multiset, Segment Trees, Greedy, Observation
                 
                     
                     Data Structures, Sets, Advanced Data Structures, Advanced Tree Structures, Algorithms
                 
               
             
             

                        Difficulty Rating:
                    

3220
Date Added:
21-06-2020
Time Limit:
2 secs
Source Limit:
50000 Bytes
Languages:
CPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM

Submit